#odoo-staging.yml

   version: '3.8'

services:
  mailhog:
    image: mailhog/mailhog:latest
    # container_name: mailhog            # ← remove to avoid name clashes
    logging:
      driver: 'none'
    restart: unless-stopped
    ports:
      # No SMTP port on host; expose only the UI (and bind it to localhost for safety)
      - "127.0.0.1:8025:8025"
    networks:
      - default

  db:
    image: postgres:17
    user: root
    environment:
      - POSTGRES_USER=odoo
      - POSTGRES_PASSWORD=2o0d2o4o18@2024
      - POSTGRES_DB=postgres
    restart: always
    volumes:
      - ./postgresql:/var/lib/postgresql/data
    networks:
      - default

  odoo18:
    image: odoo:18
    user: root
    depends_on:
      - db
      - mailhog
    ports:
      - "10018:8069"   # main Odoo
      - "20018:8072"   # live chat
    tty: true
    # command: --                         # ← remove this; it breaks the default entrypoint
    environment:
      - HOST=db
      - USER=odoo
      - PASSWORD=2o0d2o4o18@2024
      # Note: these ODOO_SMTP_* envs are NOT read by the official odoo image.
      # Configure SMTP in /etc/odoo/odoo.conf or via Odoo UI → Settings → Outgoing Mail Servers.
    volumes:
      - ./opt/shared/enterprise/18.0/odoo/addons:/mnt/enterprise
      - ./addons:/mnt/extra-addons
      - ./etc:/etc/odoo
    restart: always
    networks:
      - default

networks:
  default:
    driver: bridge



#networks:
  #default:
    #driver: bridge
  #custom_net:
    #driver: bridge
    #ipam:
     # config:
       # - subnet: 172.20.0.0/24
        #  gateway: 172.20.0.1


#networks:
  #edge:
   # external: true        # docker network create edge
